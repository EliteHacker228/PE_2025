# Table Detector Service

Сервис для автоматического определения таблиц и коррекции поворота сканированных документов с использованием YOLO модели.


## Основные возможности

- Автоматическое определение угла поворота таблиц на изображениях
- Коррекция поворота изображения для выравнивания таблиц
- REST API интерфейс для интеграции с другими сервисами
- Асинхронная обработка файлов
- Автоматическая очистка временных файлов


## Тесты

### Тестовая структура

tests/
├── test_detector.py # Юнит-тесты и интеграционные тесты обработки изображений
├── test_main.py # Тесты API эндпоинтов
└── test_load.py # Нагрузочное тестирование


### Типы тестов

#### 1. Модульные тесты детектора (`test_detector.py`)
- `test_get_angle_to_rotate`: Проверка корректности расчета угла поворота
- `test_rotate_image`: Проверка работы функции поворота изображения
- `test_no_tables_detected`: Тест обработки изображения без таблиц
- `test_invalid_image_file`: Тест обработки несуществующего файла
- `test_with_real_image`: Интеграционный тест с реалистичным изображением
- `test_process_image_file`: Мокированная проверка полного цикла обработки

#### 2. Нагрузочные тесты (`test_load.py`)
- `test_concurrent_processing`: Тестирует обработку 10 изображений в 5 потоках
                                Проверяет стабильность работы при нагрузке

#### 3. Тесты API (`test_main.py`)
- `test_upload_invalid_file`: Проверка обработки некорректного файла
- `test_image_processing_flow`: Проверка полного цикла работы API
- `test_response_format`: Проверка корректности формата ответа


### Запуск тестов

```bash
# Установите зависимости
pip install -r requirements.txt

# Запустите все тесты
pytest tests/ -v

# Только тесты обработки изображений
pytest tests/test_detector.py -v

# Только нагрузочные тесты
pytest tests/test_load.py -v

# Только API тесты
pytest tests/test_main.py -v
